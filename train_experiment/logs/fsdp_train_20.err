/bin/bash: /home/ubuntu/miniconda/envs/fsdp/lib/libtinfo.so.6: no version information available (required by /bin/bash)
Generating train split:   0%|          | 0/2119719 [00:00<?, ? examples/s]Generating train split:   2%|▏         | 37000/2119719 [00:00<00:05, 365342.87 examples/s]Generating train split:   4%|▍         | 89000/2119719 [00:00<00:04, 450788.93 examples/s]Generating train split:   7%|▋         | 144000/2119719 [00:00<00:04, 477442.80 examples/s]Generating train split:  10%|▉         | 207000/2119719 [00:00<00:03, 532930.00 examples/s]Generating train split:  13%|█▎        | 285000/2119719 [00:00<00:03, 504675.51 examples/s]Generating train split:  17%|█▋        | 352000/2119719 [00:00<00:03, 548132.35 examples/s]Generating train split:  20%|██        | 429000/2119719 [00:00<00:03, 520783.27 examples/s]Generating train split:  23%|██▎       | 495000/2119719 [00:00<00:02, 555243.59 examples/s]Generating train split:  27%|██▋       | 561930/2119719 [00:01<00:03, 398289.66 examples/s]Generating train split:  29%|██▉       | 612930/2119719 [00:01<00:03, 421487.66 examples/s]Generating train split:  32%|███▏      | 672930/2119719 [00:01<00:03, 445163.06 examples/s]Generating train split:  35%|███▍      | 736930/2119719 [00:01<00:02, 489934.66 examples/s]Generating train split:  38%|███▊      | 813930/2119719 [00:01<00:02, 490723.62 examples/s]Generating train split:  42%|████▏     | 880930/2119719 [00:01<00:02, 531849.29 examples/s]Generating train split:  45%|████▌     | 958930/2119719 [00:01<00:02, 513196.84 examples/s]Generating train split:  48%|████▊     | 1023930/2119719 [00:02<00:02, 544894.28 examples/s]Generating train split:  52%|█████▏    | 1104860/2119719 [00:02<00:01, 541103.69 examples/s]Generating train split:  55%|█████▍    | 1162860/2119719 [00:02<00:01, 545109.35 examples/s]Generating train split:  59%|█████▉    | 1245860/2119719 [00:02<00:01, 545662.15 examples/s]Generating train split:  62%|██████▏   | 1307860/2119719 [00:02<00:01, 537726.21 examples/s]Generating train split:  66%|██████▌   | 1392860/2119719 [00:02<00:01, 542631.80 examples/s]Generating train split:  68%|██████▊   | 1451860/2119719 [00:02<00:01, 542054.32 examples/s]Generating train split:  71%|███████   | 1506860/2119719 [00:02<00:01, 541837.86 examples/s]Generating train split:  74%|███████▍  | 1567860/2119719 [00:03<00:00, 556205.17 examples/s]Generating train split:  78%|███████▊  | 1655790/2119719 [00:03<00:00, 560225.00 examples/s]Generating train split:  81%|████████  | 1715790/2119719 [00:03<00:00, 568322.71 examples/s]Generating train split:  85%|████████▍ | 1800790/2119719 [00:03<00:00, 565649.55 examples/s]Generating train split:  89%|████████▊ | 1876790/2119719 [00:03<00:00, 532780.96 examples/s]Generating train split:  92%|█████████▏| 1942790/2119719 [00:03<00:00, 559933.46 examples/s]Generating train split:  95%|█████████▌| 2020790/2119719 [00:03<00:00, 531936.25 examples/s]Generating train split:  98%|█████████▊| 2085790/2119719 [00:03<00:00, 558550.29 examples/s]Generating train split: 100%|██████████| 2119719/2119719 [00:04<00:00, 522382.16 examples/s]
Generating validation split:   0%|          | 0/21990 [00:00<?, ? examples/s]Generating validation split: 100%|██████████| 21990/21990 [00:00<00:00, 575451.21 examples/s]
Traceback (most recent call last):
  File "/home/ubuntu/fs2/train_experiment/train_fsdp.py", line 105, in <module>
    main()
  File "/home/ubuntu/fs2/train_experiment/train_fsdp.py", line 92, in main
    for step, batch in enumerate(loader):
  File "/home/ubuntu/miniconda/envs/fsdp/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 630, in __next__
    data = self._next_data()
  File "/home/ubuntu/miniconda/envs/fsdp/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 674, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/home/ubuntu/miniconda/envs/fsdp/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/ubuntu/fs2/train_experiment/train_fsdp.py", line 73, in collate
    toks = tok(batch["text"], return_tensors="pt", padding=True, truncation=True)
TypeError: list indices must be integers or slices, not str
srun: error: 192-222-55-57: task 0: Exited with exit code 1
